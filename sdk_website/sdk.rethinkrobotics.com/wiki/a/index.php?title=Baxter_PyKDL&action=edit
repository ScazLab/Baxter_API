<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>View source for Baxter PyKDL - sdk-wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Baxter_PyKDL","wgTitle":"Baxter PyKDL","wgCurRevisionId":4230,"wgRevisionId":0,"wgArticleId":644,"wgIsArticle":false,"wgIsRedirect":false,"wgAction":"edit","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":true,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"Baxter_PyKDL","wgRelevantArticleId":644,"wgRequestId":"beb71aa0b5574383f36e2119","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":["autoconfirmed"],"wgRestrictionMove":["autoconfirmed"]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","site":"ready","user.options":"ready","user.tokens":"loading","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready"});mw.loader.implement("user.tokens@01doy7a",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["mediawiki.action.edit.collapsibleFooter","mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","skins.cavendishmw-rethinkrobotics"]);});</script>
<link rel="stylesheet" href="load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%252Cshared%257Cmediawiki.sectionAnchor&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics"/>
<script async="" src="load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=cavendishmw-rethinkrobotics"/>
<meta name="generator" content="MediaWiki 1.31.0"/>
<meta name="robots" content="noindex,nofollow"/>
<link rel="shortcut icon" href="../../favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="http://sdk.rethinkrobotics.com/wiki/a/opensearch_desc.php" title="sdk-wiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="http://sdk.rethinkrobotics.com/wiki/a/api.php?action=rsd"/>
<link rel="alternate" type="application/atom+xml" title="sdk-wiki Atom feed" href="http://sdk.rethinkrobotics.com/wiki/a/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/wiki/a/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=cavendishmw-rethinkrobotics&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Baxter_PyKDL rootpage-Baxter_PyKDL skin-cavendishmw-rethinkrobotics action-edit"><div id="container"><!-- start fragment header -->
    <!-- <div id="mozilla-org"><a href="#">Mozilla Skin</a></div> -->
    <div id="header" class="noprint">
        <a name="top" id="contentTop"></a>

        <!-- Logo + site name -->
        <h1>
            <a href="../../wiki" style="text-indent: 2em; width: 194px; height: 67px; background: transparent url(skins/cavendishmw-rethinkrobotics/styles/images/header_logo.png) no-repeat scroll 5px -5px;" title="Visit the main page">&nbsp;</a>        </h1>

	<div id="rr_ActionWrap">
	<!-- Account action links -->
	<div id="accountActions"><a href="http://sdk-accounts.rethinkrobotics.com/public/NewUser">Create account</a><a href="http://sdk.rethinkrobotics.com/wiki/a/index.php?title=Special:UserLogin&amp;returnto=Baxter+PyKDL&amp;returntoquery=action%3Dedit">Log in</a></div>
        <!-- Search box -->
            <form action="http://sdk.rethinkrobotics.com/wiki/a/index.php" id="searchform">
        <label for="searchInput">Search</label>
        <input type='hidden' name="title" value="Special:Search"/>
        <input type="search" name="search" placeholder="Search sdk-wiki" title="Search sdk-wiki [f]" accesskey="f" id="searchInput"/>
        &#160;
        <input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton"/>    </form>
	</div>
    </div> <!-- End header div -->
<!-- end fragment header --><div id="mBody"><!-- start fragment mainContent -->
<!-- start fragment firstHeader -->
<div id="firstHeadingDiv" class="firstHeading">
    <h1 lang="en"><span dir="auto">View source for Baxter PyKDL</span></h1>


        <!-- Content action buttons -->
        <ul><li><a href="index.php?title=Baxter_PyKDL&amp;action=edit#">More</a><ul><li id="ca-viewsource" class="selected"><a href="index.php?title=Baxter_PyKDL&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li id="ca-history"><a href="index.php?title=Baxter_PyKDL&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li></ul></li><li id="ca-nstab-main" class="selected"><a href="../Baxter_PyKDL" title="View the content page [c]" accesskey="c">Page</a></li></ul>
</div><!-- end fragment firstHeader --><!-- start fragment sidebar -->        <div id="side" class="noprint" > <!-- cavendishmw: s/column-one/side/ -->
            <ul id="nav">
                      <li><span>Navigation</span>
            <ul>
                <li id="n-Getting-Started"><a href="../Getting_Started">Getting Started</a></li>
                <li id="n-Learning"><a href="../Learning">Learning</a></li>
                <li id="n-Community"><a href="../Community">Community</a></li>
                <li id="n-Support"><a href="../Support">Support</a></li>
            </ul>
        </li>
      <li><span>Links</span>
            <ul class="collapsible-collapsed">
                <li id="n-Forum"><a href="https://groups.google.com/a/rethinkrobotics.com/forum/#!forum/brr-users" rel="nofollow">Forum</a></li>
                <li id="n-Source"><a href="https://github.com/RethinkRobotics" rel="nofollow">Source</a></li>
                <li id="n-Source-API"><a href="http://api.rethinkrobotics.com/" rel="nofollow">Source API</a></li>
            </ul>
        </li>
      <li><span>Tools</span>
            <ul class="collapsible-collapsed">
                <li id="n-All-Pages"><a href="../Special:AllPages">All Pages</a></li>
                <li id="n-Upload-File"><a href="../Special:Upload">Upload File</a></li>
                <li id="n-What-Links-Here.3F"><a href="../Special:WhatLinksHere">What Links Here?</a></li>
            </ul>
        </li>
            </ul> <!-- /nav -->
        </div> <!-- /side -->
<!-- end fragment sidebar -->
<div id="mainContent"> <!-- cavendishmw: s/column-content/mainContent/ -->
    
  <div id="bodyContent" class="mw-body">
    <div id="siteSub">From sdk-wiki</div>
    <div id="contentSub">‚Üê <a href="../Baxter_PyKDL" title="Baxter PyKDL">Baxter PyKDL</a></div>
    <div id="jump-to-nav" class="mw-jump">Jump to: <a href="index.php?title=Baxter_PyKDL&amp;action=edit#column-one">navigation</a>, <a href="index.php?title=Baxter_PyKDL&amp;action=edit#searchInput">search</a></div>
    
  <!-- start content -->
  <div id="mw-content-text"><p>You do not have permission to edit this page, for the following reasons:
</p>
<ul class="permissions-errors">
<li>The action you have requested is limited to users in the group: <a href="http://sdk.rethinkrobotics.com/wiki/a/index.php?title=Sdk-wiki:Users&amp;action=edit&amp;redlink=1" class="new" title="Sdk-wiki:Users (page does not exist)">Users</a>.</li>
<li>This page has been protected to prevent editing or other actions.</li>
</ul>
<hr />
<p>You can view and copy the source of this page.
</p><textarea readonly="" accesskey="," id="wpTextbox1" cols="80" rows="25" style="" class="mw-editfont-monospace" lang="en" dir="ltr" name="wpTextbox1">[[File:Orocos_kdl.png|link=http://www.orocos.org/kdl|Orocos KDL]]

'''[http://moveit.ros.org/wiki/MoveIt! Orocos Kinematics and Dynamics with Baxter! Please visit the Orocos KDL (Kinematics Dynamics Library) homepage for more information]'''
== Summary ==
This is a project for live Python KDL ([http://www.orocos.org/kdl Orocos Kinematics and Dynamics Library]) usage with Baxter. Forward Kinematics, Inverse Kinematics, Jacobian, Jacobian Tranpose, Jacobian Pseudo-Inverse, Joint and Cartesian Inertias..

== Author ==
[[User:Kyle_maroney | Kyle Maroney]]

== Project Site ==
https://github.com/RethinkRobotics/baxter_pykdl

== Installation ==

=== Prerequisites ===
&lt;b>Note:&lt;/b> These prerequisite packages &lt;b>have already been installed on your robot&lt;/b>, so you should skip this step when using &lt;b>SSH&lt;/b> with baxter_pykdl.
&lt;tabs>
&lt;tab name="ROS Indigo">
&lt;source lang="bash">
    $ sudo apt-get install ros-indigo-python-orocos-kdl  ros-indigo-orocos-kinematics-dynamics ros-indigo-kdl-conversions ros-indigo-orocos-kdl
&lt;/source>
&lt;/tab>
&lt;tab name="ROS Hydro">
&lt;source lang="bash">
    $ sudo apt-get install ros-hydro-python-orocos-kdl ros-hydro-kdl ros-groovy-kdl-conversions ros-hydro-orocos-kdl
&lt;/source>
&lt;/tab>
&lt;tab name="ROS Groovy">
&lt;source lang="bash">
    $ sudo apt-get install ros-groovy-python-orocos-kdl ros-groovy-kdl ros-groovy-kdl-conversions ros-groovy-orocos-kdl
&lt;/source>
&lt;/tab>
&lt;/tabs>

=== Checkout and build the baxter_pykdl package ===

&lt;source lang="bash">
    $ cd ~/ros_ws/src
    $ git clone https://github.com/RethinkRobotics/baxter_pykdl.git
    # All work is in master
    $ cd ~/ros_ws
    $ source ./baxter.sh
    $ catkin_make
&lt;/source>

== Description ==

This package was based on the [http://wiki.ros.org/pykdl_utils pykdl_utils] package from Georgia Tech (Kelsey Hawkins).

The idea is to use the [http://www.orocos.org/kdl Orocos Project's Kinematics and Dynamics library] for the kinematic and dynamic analysis of Baxter in Python using the Rethink Python SDK.

A class is provided in this package, baxter_kinematics, which reads from the parameter server of the robot you are connected to pulling the URDF. It then parses that URDF into the expected Orocos kinematic description, a [http://people.mech.kuleuven.be/~rsmits/kdl/api/html/classKDL_1_1Tree.html kdl tree]. It then, based on the limb specified creates a kinematic chain (base -> gripper frames) on which we will conduct our analysis.

As of the SDK 1.0 release, the URDF loaded to the parameter server is the same model represented in robot memory. This means that our calculations performed here in the pykdl package should match the output of the robot.

The baxter_kinematics class provides the following methods:

== Class ==
* '''baxter_kinematics'''
** args: limb (required) - limb we will work on ['left', 'right']
** description: Baxter Kinematics using Python Kinematics and Dynamics Library with the baxter_interface

== Methods ==

* '''forward_position_kinematics'''
** args: None
** description: Solves the forward position kinematics read from the limb's current joint angles
** returns numpy array [x, y, z, rot_i, rot_j, rot_k, rot_w]

* '''forward_velocity_kinematics'''
** args: None
** description: Solves the forward velocity kinematics read from the limb's current joint velocities
** returns KDL FrameVel Twist (Not yet working..)

* '''inverse_kinematics'''
** args:
*** position (list) - Cartesian Position, Orientation (optional) [x, y, z]
*** orientation (list) [Optional] - Quaternion Orientation [i, j, k, w]
*** seed (list) [Optional] - Seeded joint angles for solver. Searchs out from seeded joint angles for IK solution [s0, s1, e0, e1, w0, w1, w2]
** description: Solves the inverse kinematics, providing joint angles given a Cartesian pose

* '''forward_velocity_kinematics'''
** args: None
** description: Solves the inverse kinematics, providing joint angles given a Cartesian pose
** returns: List of joint angles [s0, s1, e0, e1, w0, w1, w2]

* '''jacobian'''
** args: None
** description: Solves the Jacobian reading the robot's current joint angles
** returns: numpy mat Jacobian

* '''jacobian_transpose'''
** args: None
** description: Tranposes the solved Jacobian
** returns: numpy mat Jacobian (Transposed)
  
* '''jacobian_pseudo_inverse'''
** args: None
** description: Solves for the Jacobian Pseudo-Inverse using numpy's linear algebra library (pinv)
** return: numpy mat Jacobian (Pseudo-Inverse)

* '''inertia'''
** args: None
** description: Solves for joint space inertias
** return: numpy matrix Joint Inertias

* '''cart_inertia'''
** args: None
** description: Solves for Cartesian space inertias
** return: numpy matrix Cartesian Inertias
 
* '''print_kdl_chain'''
** args: None
** description: Crawls the kinematic chain, printing the link names

* '''joints_to_kdl'''
** args: type (string) - supported types ['positions', 'velocities', 'torques']
** description: Gets the current arm joint values specified by the type argument, returns in the expected KDL form.

* '''kdl_to_mat'''
** args: data (matrix) - kdl matrix in
** description: Converts output kdl matrices into useful numpy mat (matrix) form

* '''kdl_to_mat'''
** args: data (matrix) - kdl matrix in
** description: Converts output kdl matrices into useful numpy mat (matrix) form

== Run Examples ==

I've added two example scripts. One to call each of the methods, printing their result, and another simple script for verifying and validating the URDF loaded to the parameter server.

These are found in the scripts folder.

=== display_urdf.py ===
This example retrieves the current URDF loaded to the parameter server and parses it, printing the model.

Run with a [[RSDK_Shell properly initialized shell]]:
&lt;source lang="bash">
    $ cd ~/ros_ws
    $ rosrun baxter_pykdl display_urdf.py
&lt;/source>

=== baxter_kinematics.py ===
This example calls all of the baxter_kinematics classes' kinematics methods. FK, IK, Jacobian, Jacobian Transpose, Jacobian Pseudo-Inverse, Joint Inertia, Cartesian Inertias, and model analysis prints.

Run with a [[RSDK_Shell | properly initialized shell]]:
&lt;source lang="bash">
    $ cd ~/ros_ws
    $ rosrun baxter_pykdl baxter_kinematics.py
&lt;/source>

That's it! Enjoy!

Let me know if you have any feedback (kmaroney at rethinkrobotics dot com)!

== Troubleshooting ==

Drop a question on the [https://groups.google.com/a/rethinkrobotics.com/forum/#!forum/brr-users Baxter Research Robot Users (brr-users) forum/mailing list]
</textarea><div class="templatesUsed"></div><p id="mw-returnto">Return to <a href="../Baxter_PyKDL" title="Baxter PyKDL">Baxter PyKDL</a>.</p>
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="../Baxter_PyKDL">http://sdk.rethinkrobotics.com/wiki/Baxter_PyKDL</a>"</div>
  <div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>  <!-- end content -->
  
    <div class="visualClear"></div>
</div>
</div> <!-- /mainContent -->
<!-- end fragment mainContent --></div> <!-- /mBody --><div class="visualClear"></div><!-- start fragment footer -->    <div id="footer" role="contentinfo">
        <div id="f-poweredbyico">
                <a href="http://www.mediawiki.org/"><img src="resources/assets/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/wiki/a/resources/assets/poweredby_mediawiki_132x47.png 1.5x, /wiki/a/resources/assets/poweredby_mediawiki_176x62.png 2x" width="88" height="31"/></a>
            </div>
        <ul id="f-list">
                <li id="copywrite_notice">&copy; 2015 Rethink Robotics. All rights reserved.</li>
                <li id="special_pages"><a href="../Special:SpecialPages" title="Special:SpecialPages">SpecialPages</a></li>
                <li id="privacy"><a href="../Sdk-wiki:Privacy_policy" title="Sdk-wiki:Privacy policy">Privacy policy</a></li>
                <li id="about"><a href="../Sdk-wiki:About" title="Sdk-wiki:About">About sdk-wiki</a></li>
                <li id="disclaimer"><a href="../Sdk-wiki:General_disclaimer" title="Sdk-wiki:General disclaimer">Disclaimers</a></li>
            </ul>
    </div><!-- end fragment footer --></div><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":53});});</script></body></html>